<!DOCTYPE html>
<html>
<head>
        <link rel="stylesheet" href="main.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script>
        function inputDesserts() {
            for (var i = 2; i< 5; i++){
                addDessert(i);
                getComments(i);
            }
        }

        function addDessert(id) {
            var httpRequest = new XMLHttpRequest();
            httpRequest.onreadystatechange = function() {
                if(this.readyState === 4 && this.status === 200) {
                    var newObj = JSON.parse(httpRequest.responseText);
                    addResults(newObj);

                }
            };
            httpRequest.open("GET", '/getDessert?id='+ id, true);
            httpRequest.send();
            console.log("Getting id:" + id);
        }
        function addResults(json) {
            console.log(json);

            var result = document.getElementById('results');
            var newItem = document.createElement('p');
            var text = document.createTextNode('');
            
            newItem.appendChild(text);
    
            newItem.innerHTML = "<div class='container'> <div class='box'><h2>" + json.name + "</h2><br>" 
                  + "Description: " + json.description + "<br><p id='comments'></p>"
                  + "<button class='submit' onclick='getDetails'>Add Comment</button> </div></div>"; 
                  //+ <img src='" + json.image + "' ><br>"; 
             result.appendChild(newItem);
        }

        function getComments(id){
            var httpRequest = new XMLHttpRequest();
        
            httpRequest.onreadystatechange = function() {
                if(this.readyState === 4 && this.status === 200) {
                    var newObj = JSON.parse(httpRequest.responseText);
                    displayComments(newObj, id);

                }
            };
            httpRequest.open("GET", '/getComment?id='+ id  , true);
            httpRequest.send();
            console.log("Comment for:" + id);
        }

        function displayComments(json, id){
            console.log(json);
            var details = document.getElementById("details");


            details.innerHTML +=  json.Length;

        }

    </script>
</head>
<body onload="inputDesserts()">
    <h1>Desserts</h1>
    <p id="results"></p>
    <p id="details"></p>



</body>
</html>
